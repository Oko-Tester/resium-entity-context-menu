{"version":3,"sources":["../src/components/EntityContextMenu.tsx","../src/hooks/useEntityContextMenu.tsx","../src/contexts/ContextMenuProvider.tsx"],"sourcesContent":["import { useRef, useState, useEffect, useCallback, useLayoutEffect } from 'react';\nimport { useEntityContextMenu } from '../hooks/useEntityContextMenu';\nimport { MenuItem } from '../types/index';\nimport '../components/EntityContextMenu.css';\nimport { useCesium } from 'resium';\nimport { ScreenSpaceEventHandler, ScreenSpaceEventType } from 'cesium';\n\nexport const EntityContextMenu: React.FC<{ className?: string }> = ({ className = '' }) => {\n  const { isVisible, context, menuItems, isLoading, hideMenu } = useEntityContextMenu();\n  const menuRef = useRef<HTMLDivElement>(null);\n  const [focusedIndex, setFocusedIndex] = useState(0);\n  const [openSubmenu, setOpenSubmenu] = useState<string | null>(null);\n  const [submenuFocusedIndex, setSubmenuFocusedIndex] = useState<number | null>(null);\n  const [menuPosition, setMenuPosition] = useState({ x: 0, y: 0 });\n  const [positionCalculated, setPositionCalculated] = useState(false);\n  const { viewer } = useCesium();\n\n  useEffect(() => {\n    if (!viewer) return;\n\n    const handler = new ScreenSpaceEventHandler(viewer.scene.canvas);\n\n    handler.setInputAction(() => {\n      if (isVisible) hideMenu();\n    }, ScreenSpaceEventType.RIGHT_DOWN);\n\n    handler.setInputAction(() => {\n      if (isVisible) hideMenu();\n    }, ScreenSpaceEventType.LEFT_DOWN);\n\n    const canvas = viewer.scene.canvas;\n    const prevent = (e: Event) => e.preventDefault();\n    canvas.addEventListener('contextmenu', prevent);\n\n    return () => {\n      handler.destroy();\n      canvas.removeEventListener('contextmenu', prevent);\n    };\n  }, [viewer?.scene.canvas, isVisible, hideMenu]);\n\n  const computeMenuPosition = (ctx: typeof context, menuEl: HTMLDivElement | null) => {\n    if (!ctx || !viewer) return { x: 0, y: 0 };\n\n    let canvasX = ctx.position?.x ?? 0;\n    let canvasY = ctx.position?.y ?? 0;\n\n    const canvas = viewer.scene.canvas;\n    const canvasRect = canvas.getBoundingClientRect();\n\n    let x = canvasRect.left + canvasX;\n    let y = canvasRect.top + canvasY;\n\n    if (menuEl) {\n      const rect = menuEl.getBoundingClientRect();\n      const viewportWidth = window.innerWidth;\n      const viewportHeight = window.innerHeight;\n\n      if (x + rect.width > viewportWidth - 10) {\n        x = Math.max(10, x - rect.width);\n      }\n\n      if (y + rect.height > viewportHeight - 10) {\n        y = Math.max(10, y - rect.height);\n      }\n    }\n\n    return { x, y };\n  };\n\n  useLayoutEffect(() => {\n    if (!isVisible || !context) {\n      setPositionCalculated(false);\n      return;\n    }\n\n    const menuEl = menuRef.current;\n    const pos = computeMenuPosition(context, menuEl);\n    setMenuPosition(pos);\n    setPositionCalculated(true);\n  }, [isVisible, context, menuItems, viewer]);\n\n  useEffect(() => {\n    if (!isVisible) return;\n\n    const handleOutsideInteraction = (e: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(e.target as Node)) {\n        hideMenu();\n      }\n    };\n    const handleScroll = () => hideMenu();\n    const handleEscape = (evt: KeyboardEvent) => {\n      if (evt.key === 'Escape') hideMenu();\n    };\n\n    document.addEventListener('mousedown', handleOutsideInteraction);\n    document.addEventListener('click', handleOutsideInteraction);\n    document.addEventListener('scroll', handleScroll, true);\n    document.addEventListener('wheel', handleScroll, true);\n    document.addEventListener('keydown', handleEscape);\n\n    return () => {\n      document.removeEventListener('mousedown', handleOutsideInteraction);\n      document.removeEventListener('click', handleOutsideInteraction);\n      document.removeEventListener('scroll', handleScroll, true);\n      document.removeEventListener('wheel', handleScroll, true);\n      document.removeEventListener('keydown', handleEscape);\n    };\n  }, [isVisible, hideMenu]);\n\n  useEffect(() => {\n    if (isVisible && positionCalculated && menuRef.current) {\n      menuRef.current.focus();\n    }\n  }, [isVisible, positionCalculated]);\n\n  useEffect(() => {\n    setFocusedIndex(0);\n    setOpenSubmenu(null);\n    setSubmenuFocusedIndex(null);\n  }, [menuItems]);\n\n  const isItemEnabled = useCallback(\n    (item: MenuItem) => {\n      if (!item.enabled) return true;\n      if (typeof item.enabled === 'boolean') return item.enabled;\n      return !!context && item.enabled(context);\n    },\n    [context],\n  );\n\n  const handleKeyDown = useCallback(\n    (e: React.KeyboardEvent) => {\n      if (!menuItems || menuItems.length === 0) return;\n\n      const visibleItems = menuItems.filter(\n        (item) => item.type !== 'separator' && (!item.visible || item.visible(context!)),\n      );\n\n      if (visibleItems.length === 0) return;\n\n      if (submenuFocusedIndex !== null && openSubmenu) {\n        const currentItem = visibleItems[focusedIndex];\n        if (currentItem?.type === 'submenu' && currentItem.items) {\n          const visibleSubmenuItems = currentItem.items.filter(\n            (item) => item.type !== 'separator' && (!item.visible || item.visible(context!)),\n          );\n\n          switch (e.key) {\n            case 'ArrowDown':\n              e.preventDefault();\n              setSubmenuFocusedIndex((prev) =>\n                prev === null ? 0 : (prev + 1) % visibleSubmenuItems.length,\n              );\n              break;\n            case 'ArrowUp':\n              e.preventDefault();\n              setSubmenuFocusedIndex((prev) =>\n                prev === null\n                  ? 0\n                  : (prev - 1 + visibleSubmenuItems.length) % visibleSubmenuItems.length,\n              );\n              break;\n            case 'Enter':\n            case ' ':\n              e.preventDefault();\n              {\n                const focusedSubItem = visibleSubmenuItems[submenuFocusedIndex];\n                if (!focusedSubItem) break;\n\n                const enabled = isItemEnabled(focusedSubItem);\n                if (!enabled) break;\n\n                if (focusedSubItem.onClick) {\n                  const res = focusedSubItem.onClick(context!);\n                  if (res instanceof Promise) {\n                    res.finally(() => hideMenu());\n                  } else {\n                    hideMenu();\n                  }\n                }\n              }\n              break;\n            case 'ArrowLeft':\n              e.preventDefault();\n              setSubmenuFocusedIndex(null);\n              break;\n            case 'Escape':\n              e.preventDefault();\n              setOpenSubmenu(null);\n              setSubmenuFocusedIndex(null);\n              break;\n          }\n          return;\n        }\n      }\n\n      switch (e.key) {\n        case 'ArrowDown':\n          e.preventDefault();\n          setFocusedIndex((prev) => (prev + 1) % visibleItems.length);\n          setSubmenuFocusedIndex(null);\n          break;\n        case 'ArrowUp':\n          e.preventDefault();\n          setFocusedIndex((prev) => (prev - 1 + visibleItems.length) % visibleItems.length);\n          setSubmenuFocusedIndex(null);\n          break;\n        case 'Enter':\n        case ' ':\n          e.preventDefault();\n          {\n            const focusedItem = visibleItems[focusedIndex];\n            if (!focusedItem) break;\n\n            const enabled = isItemEnabled(focusedItem);\n            if (!enabled) break;\n\n            if (focusedItem.type === 'submenu' && focusedItem.items) {\n              setOpenSubmenu(focusedItem.id);\n              setSubmenuFocusedIndex(0);\n            } else if (focusedItem.onClick) {\n              const res = focusedItem.onClick(context!);\n              if (res instanceof Promise) {\n                res.finally(() => hideMenu());\n              } else {\n                hideMenu();\n              }\n            }\n          }\n          break;\n        case 'ArrowRight': {\n          const item = visibleItems[focusedIndex];\n          if (item?.type === 'submenu' && item.items) {\n            e.preventDefault();\n            setOpenSubmenu(item.id);\n            setSubmenuFocusedIndex(0);\n          }\n          break;\n        }\n        case 'ArrowLeft':\n          e.preventDefault();\n          setOpenSubmenu(null);\n          setSubmenuFocusedIndex(null);\n          break;\n      }\n    },\n    [menuItems, context, focusedIndex, submenuFocusedIndex, openSubmenu, hideMenu, isItemEnabled],\n  );\n\n  if (!isVisible) return null;\n\n  const renderMenuItem = (\n    item: MenuItem,\n    index: number,\n    parentId?: string,\n    visibleItemIndex?: number,\n    isSubmenuItem?: boolean,\n  ): React.ReactNode => {\n    if (!context) return null;\n\n    if (item.visible && !item.visible(context)) {\n      return null;\n    }\n\n    const isEnabled = isItemEnabled(item);\n    const isFocused = isSubmenuItem\n      ? submenuFocusedIndex === visibleItemIndex\n      : visibleItemIndex !== undefined && visibleItemIndex === focusedIndex;\n\n    if (item.type === 'separator') {\n      return <div key={item.id ?? `sep-${index}`} className=\"ecm-separator\" />;\n    }\n\n    if (item.type === 'custom' && item.render) {\n      return (\n        <div key={item.id ?? `custom-${index}`} className=\"ecm-custom\">\n          {item.render(context)}\n        </div>\n      );\n    }\n\n    const handleClick = async () => {\n      if (!isEnabled) return;\n\n      if (item.type === 'submenu' && item.items) {\n        setOpenSubmenu(openSubmenu === item.id ? null : item.id);\n      } else if (item.onClick) {\n        try {\n          const res = item.onClick(context);\n          if (res instanceof Promise) await res;\n        } finally {\n          hideMenu();\n        }\n      }\n    };\n\n    const itemKey = parentId ? `${parentId}__${item.id ?? index}` : `${item.id ?? index}`;\n\n    return (\n      <div\n        key={itemKey}\n        role=\"menuitem\"\n        tabIndex={isFocused ? 0 : -1}\n        onContextMenu={(e) => e.preventDefault()}\n        className={[\n          'ecm-item',\n          isEnabled ? 'ecm-item--enabled' : 'ecm-item--disabled',\n          isFocused ? 'ecm-item--focused' : '',\n          item.type === 'toggle' ? 'ecm-item--toggle' : '',\n          item.type === 'submenu' ? 'ecm-item--submenu' : '',\n        ]\n          .join(' ')\n          .trim()}\n        onClick={handleClick}\n        onMouseEnter={() => {\n          if (isSubmenuItem && visibleItemIndex !== undefined) {\n            setSubmenuFocusedIndex(visibleItemIndex);\n          } else if (visibleItemIndex !== undefined) {\n            setFocusedIndex(visibleItemIndex);\n            setSubmenuFocusedIndex(null);\n          }\n        }}\n      >\n        {item.type === 'toggle' && (item as any).checked && (\n          <span className=\"ecm-checkmark\">✓</span>\n        )}\n\n        {item.icon && <span className=\"ecm-item__icon\">{item.icon}</span>}\n\n        <span className=\"ecm-item__label\">{item.label}</span>\n\n        {item.type === 'submenu' && <span className=\"ecm-item__submenu-indicator\">▶</span>}\n\n        {item.type === 'submenu' && openSubmenu === item.id && item.items && (\n          <div className=\"ecm-submenu\">\n            {(() => {\n              let submenuVisibleIndex = 0;\n              return item.items.map((subItem, subIndex) => {\n                const shouldRender = !subItem.visible || subItem.visible(context!);\n                const isActuallyVisible = shouldRender && subItem.type !== 'separator';\n                const currentSubmenuIndex = isActuallyVisible ? submenuVisibleIndex : undefined;\n\n                if (isActuallyVisible) {\n                  submenuVisibleIndex++;\n                }\n\n                return renderMenuItem(subItem, subIndex, item.id, currentSubmenuIndex, true);\n              });\n            })()}\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  if (!isVisible) return null;\n  return (\n    <div\n      ref={menuRef}\n      role=\"menu\"\n      tabIndex={-1}\n      onContextMenu={(e) => e.preventDefault()}\n      className={`ecm-menu ${className}`}\n      style={{\n        left: `${menuPosition.x}px`,\n        top: `${menuPosition.y}px`,\n        visibility: positionCalculated ? 'visible' : 'hidden',\n        opacity: positionCalculated ? 1 : 0,\n        transition: 'opacity 0.1s ease-in-out',\n      }}\n      onKeyDown={handleKeyDown}\n    >\n      {isLoading ? (\n        <div className=\"ecm-loading\">Loading menu...</div>\n      ) : menuItems && menuItems.length > 0 ? (\n        <div className=\"ecm-list\">\n          {(() => {\n            let visibleItemIndex = 0;\n            return menuItems.map((item, index) => {\n              const shouldRender = !item.visible || item.visible(context!);\n              const isActuallyVisible = shouldRender && item.type !== 'separator';\n              const currentVisibleIndex = isActuallyVisible ? visibleItemIndex : undefined;\n\n              if (isActuallyVisible) {\n                visibleItemIndex++;\n              }\n\n              return renderMenuItem(item, index, undefined, currentVisibleIndex);\n            });\n          })()}\n        </div>\n      ) : (\n        <div className=\"ecm-empty\">No actions available</div>\n      )}\n    </div>\n  );\n};\n","import { useContext } from 'react';\nimport { ContextMenuContext } from '../contexts/ContextMenuProvider';\n\nexport function useEntityContextMenu() {\n  const context = useContext(ContextMenuContext);\n  if (!context) {\n    throw new Error('useEntityContextMenu must be used within EntityContextMenuProvider');\n  }\n  return context;\n}\n","import { createContext, useState, useCallback } from 'react';\nimport {\n  ContextMenuState,\n  EntityContext,\n  MenuFactory,\n  MenuItem,\n  EntityContextMenuProviderProps,\n} from '../types/index';\n\nexport const ContextMenuContext = createContext<ContextMenuState | null>(null);\n\nexport const EntityContextMenuProvider: React.FC<EntityContextMenuProviderProps> = ({\n  children,\n  defaultFactory,\n  factoriesByType = {},\n  onOpen,\n  onClose,\n}) => {\n  const [isVisible, setIsVisible] = useState(false);\n  const [context, setContext] = useState<EntityContext | undefined>();\n  const [menuItems, setMenuItems] = useState<MenuItem[] | undefined>();\n  const [isLoading, setIsLoading] = useState(false);\n\n  const resolveFactory = useCallback(\n    (ctx: EntityContext): MenuFactory => {\n      if (ctx.entityData?.menuFactory && typeof ctx.entityData.menuFactory === 'function') {\n        return ctx.entityData.menuFactory;\n      }\n      if (ctx.entityType && factoriesByType[ctx.entityType]) {\n        return factoriesByType[ctx.entityType];\n      }\n      return defaultFactory;\n    },\n    [defaultFactory, factoriesByType],\n  );\n\n  const showMenu = useCallback(\n    async (ctx: EntityContext) => {\n      setContext(ctx);\n      setIsVisible(true);\n      setIsLoading(true);\n      setMenuItems(undefined);\n\n      onOpen?.(ctx);\n\n      try {\n        const factory = resolveFactory(ctx);\n        const items = await factory(ctx);\n        setMenuItems(items);\n      } catch (error) {\n        console.error('Failed to resolve menu items:', error);\n        setMenuItems([]);\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [resolveFactory, onOpen],\n  );\n\n  const hideMenu = useCallback(() => {\n    setIsVisible(false);\n    setContext(undefined);\n    setMenuItems(undefined);\n    setIsLoading(false);\n    onClose?.();\n  }, [onClose]);\n\n  const value: ContextMenuState = {\n    isVisible,\n    context,\n    menuItems,\n    isLoading,\n    showMenu,\n    hideMenu,\n  };\n\n  return <ContextMenuContext.Provider value={value}>{children}</ContextMenuContext.Provider>;\n};\n"],"mappings":"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","names":["useState","useCallback","jsx","useState","useCallback"]}